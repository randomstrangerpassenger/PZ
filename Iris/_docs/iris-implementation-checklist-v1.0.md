# Iris 설명 생성 구현 체크리스트

**버전**: 1.0  
**상태**: PRE-IMPLEMENTATION  
**문서 유형**: 구현 검증 체크리스트

---

## 1. 목적

이 문서는 Iris 설명 생성 시스템 구현 전/중/후에 **검증해야 할 항목**을 정의한다.

### 1.1 사용 시점

| 시점 | 용도 |
|------|------|
| 구현 전 | 필수 입력 데이터 확인 |
| 구현 중 | 단계별 구현 완료 확인 |
| 구현 후 | 헌법 준수 검증 |

### 1.2 판정 기준

- ✅ 통과
- ❌ 실패 (구현 중단, 원인 분석 필요)
- ⚠️ 경고 (진행 가능, 추후 보완 필요)

---

## 2. 구현 전 체크리스트

### 2.1 필수 문서 확인

| # | 항목 | 파일명 | 확인 |
|---|------|--------|------|
| 1 | 헌법 | Philosophy.md | ☐ |
| 2 | 설명 설계 스펙 | iris-item-description-spec-v1.0.md | ☐ |
| 3 | 파이프라인 스펙 | iris-description-pipeline-spec-v1.0.md | ☐ |
| 4 | 소분류 템플릿 | iris-subcategory-template-v1.1.md | ☐ |
| 5 | Evidence Allowlist | iris-evidence-allowlist.md | ☐ |
| 6 | Rule DSL 스펙 | iris-rule-dsl-spec-v1_2.md | ☐ |

### 2.2 필수 데이터 확인

| # | 항목 | 설명 | 확인 |
|---|------|------|------|
| 1 | 분류 엔진 출력 | 아이템 → 소분류 태그 매핑 | ☐ |
| 2 | 템플릿 데이터 | 소분류 코드 → 템플릿 문장 매핑 | ☐ |
| 3 | 주 소분류 메타 (선택) | iris_meta.json 또는 동등 구조 | ☐ |

### 2.3 의존성 확인

| # | 항목 | 설명 | 확인 |
|---|------|------|------|
| 1 | 분류 엔진 | 소분류 태그를 정상 출력하는가 | ☐ |
| 2 | 아이템 데이터 | FullType으로 아이템 조회 가능한가 | ☐ |
| 3 | Lua 환경 | PZ Lua API 접근 가능한가 | ☐ |

---

## 3. 구현 중 체크리스트 (단계별)

### 3.1 단계 1: 소분류 수집 (Collection)

| # | 검증 항목 | 기대 결과 | 확인 |
|---|-----------|-----------|------|
| 1 | 아이템에서 소분류 태그 추출 | 태그 집합 반환 | ☐ |
| 2 | 중복 태그 처리 | 1개로 통합 | ☐ |
| 3 | 소분류 0개 처리 | 빈 집합 반환 (오류 아님) | ☐ |
| 4 | 잘못된 태그 형식 처리 | 경고 로그 출력, 해당 태그 무시 (출력 보정/대체 금지, 파이프라인 계속 진행) | ☐ |

**테스트 케이스**:
```
입력: Base.Hammer
기대: { Tool.1-A, Tool.1-B, Combat.2-C }

입력: Base.UnknownItem (태그 없음)
기대: { }
```

---

### 3.2 단계 2: 주 소분류 결정 (Anchor)

> **소분류 식별자 표준 포맷**: `{대분류}.{번호}-{코드}` (예: `Tool.1-A`, `Combat.2-C`)

| # | 검증 항목 | 기대 결과 | 확인 |
|---|-----------|-----------|------|
| 1 | iris_meta에 primary_subcategory 있음 | 해당 값 사용 | ☐ |
| 2 | iris_meta 없음 | 대분류 번호 순 첫 번째 | ☐ |
| 3 | 소분류 0개 | anchor = nil | ☐ |
| 4 | 대분류 번호 순 정렬 | Tool < Combat < Consumable < Resource < Literature < Wearable | ☐ |
| 5 | 동일 대분류 내 정렬 | A < B < C < ... | ☐ |

**테스트 케이스**:
```
입력: { Combat.2-C, Tool.1-A, Tool.1-B }, meta 없음
기대: Tool.1-A

입력: { Combat.2-C, Tool.1-D }, meta = { primary: "Tool.1-D" }
기대: Tool.1-D

입력: { Consumable.3-A, Consumable.3-B }
기대: Consumable.3-A
```

---

### 3.3 단계 3: 소분류 정렬 (Ordering)

| # | 검증 항목 | 기대 결과 | 확인 |
|---|-----------|-----------|------|
| 1 | 주 소분류가 첫 번째 | anchor가 리스트 맨 앞 | ☐ |
| 2 | 나머지는 대분류 번호 순 | 정렬 순서 유지 | ☐ |
| 3 | 소분류 1개 | 그대로 반환 | ☐ |
| 4 | 소분류 0개 | 빈 리스트 반환 | ☐ |

**테스트 케이스**:
```
입력: { Combat.2-C, Tool.1-A, Tool.1-B }, anchor = Tool.1-A
기대: [ Tool.1-A, Tool.1-B, Combat.2-C ]

입력: { Resource.4-A, Consumable.3-B }, anchor = Consumable.3-B
기대: [ Consumable.3-B, Resource.4-A ]
```

---

### 3.4 단계 4: 템플릿 바인딩 (Template Bind)

| # | 검증 항목 | 기대 결과 | 확인 |
|---|-----------|-----------|------|
| 1 | 소분류 → 템플릿 매핑 | 올바른 템플릿 반환 | ☐ |
| 2 | 템플릿 없는 소분류 | nil 반환 (블록 생략의 단일 트리거) | ☐ |
| 3 | 템플릿 문장 무결성 | 원본과 동일 (수정 없음) | ☐ |

**테스트 케이스**:
```
입력: Tool.1-A
기대: "이 아이템은 건설이나 제작 작업에 사용되는 도구다..."

입력: Tool.1-Z (존재하지 않음)
기대: nil
```

---

### 3.5 단계 5: 블록 활성화 (Block Activation)

| # | 검증 항목 | 기대 결과 | 확인 |
|---|-----------|-----------|------|
| 1 | 태그 존재 → 블록 활성화 | 블록 전체 포함 | ☐ |
| 2 | 블록 단위 활성화 | 문장별 분기 없음 | ☐ |
| 3 | Evidence 재검사 없음 | 분류 결과만 사용 | ☐ |

**금지 동작 확인**:
| # | 금지 항목 | 발생 여부 | 확인 |
|---|-----------|-----------|------|
| 1 | 문장별 조건 분기 | 없어야 함 | ☐ |
| 2 | Evidence 필드 참조 | 없어야 함 | ☐ |
| 3 | 런타임 문장 생성 | 없어야 함 | ☐ |

---

### 3.6 단계 6: 빈 블록 처리 (Empty Handling)

| # | 검증 항목 | 기대 결과 | 확인 |
|---|-----------|-----------|------|
| 1 | 소분류 0개 | 빈 출력 | ☐ |
| 2 | 템플릿 없는 소분류 | 해당 블록 생략 | ☐ |
| 3 | 자동 보완 없음 | "정보 없음" 같은 문구 없음 | ☐ |

**금지 동작 확인**:
| # | 금지 항목 | 발생 여부 | 확인 |
|---|-----------|-----------|------|
| 1 | 기본 설명 삽입 | 없어야 함 | ☐ |
| 2 | 대체 문구 삽입 | 없어야 함 | ☐ |
| 3 | 폴백 로직 | 없어야 함 | ☐ |

---

### 3.7 단계 7: 최종 조합 (Render)

| # | 검증 항목 | 기대 결과 | 확인 |
|---|-----------|-----------|------|
| 1 | 헤더 형식 | "[소분류명 (코드)]" | ☐ |
| 2 | 블록 순서 | 단계 3 결과 유지 | ☐ |
| 3 | 블록 구분 | 빈 줄 1개 | ☐ |
| 4 | 문장 무결성 | 템플릿 원본 유지 | ☐ |

**출력 형식 검증**:
```
[Tool · Construction (1-A)]
이 아이템은 건설이나 제작 작업에 사용되는 도구다.
특정 구조물이나 가구를 만들거나 조립할 때 필요하다.

[Combat · Short Blunt (2-C)]
이 아이템은 근접 전투에서 둔기 계열 무기로 취급된다.
한 손으로 사용할 수 있다.
```

---

## 4. 구현 후 체크리스트

### 4.1 헌법 준수 검증

| # | 원칙 | 검증 방법 | 확인 |
|---|------|-----------|------|
| 1 | No inference | 출력에 추론된 문장 없음 | ☐ |
| 2 | Fail-loud | 빈 결과가 오류 없이 처리됨 | ☐ |
| 3 | Add-only | 태그 제거/대체 로직 없음 | ☐ |
| 4 | 판단 금지 | "좋다/나쁘다/효율적" 없음 | ☐ |
| 5 | 추천 금지 | "추천/권장" 없음 | ☐ |
| 6 | 비교 금지 | "A보다 B가" 없음 | ☐ |

### 4.2 금지 문구 검출

출력에 다음 패턴이 **없어야 함**:

| # | 금지 패턴 | 예시 | 확인 |
|---|-----------|------|------|
| 1 | 추천 표현 | "추천", "권장", "~하세요" | ☐ |
| 2 | 평가 표현 | "좋다", "나쁘다", "효율적", "유용" | ☐ |
| 3 | 비교 표현 | "보다", "더", "가장", "최고" | ☐ |
| 4 | 추측 표현 | "~일 것이다", "~할 수 있을 것" | ☐ |
| 5 | 요약 표현 | "다목적", "만능", "주로" | ☐ |
| 6 | 시점 표현 | "초반", "후반", "엔드게임" | ☐ |

### 4.3 통합 테스트

| # | 테스트 케이스 | 기대 결과 | 확인 |
|---|---------------|-----------|------|
| 1 | 단일 소분류 아이템 | 블록 1개 출력 | ☐ |
| 2 | 다중 소분류 아이템 | 블록 N개, 정렬 순서 정확 | ☐ |
| 3 | 소분류 없는 아이템 | 빈 출력, 오류 없음 | ☐ |
| 4 | primary_subcategory 지정 | 지정된 블록이 첫 번째 | ☐ |
| 5 | 동일 대분류 다중 소분류 | 코드 순 정렬 (A < B < C) | ☐ |

### 4.4 경계 케이스

| # | 케이스 | 기대 동작 | 확인 |
|---|--------|-----------|------|
| 1 | 소분류 10개 이상 | 모두 표시, 순서 정확 | ☐ |
| 2 | 템플릿 누락 소분류 | 해당 블록만 생략 | ☐ |
| 3 | 잘못된 소분류 코드 | 경고 로그 출력, 해당 태그 무시 | ☐ |
| 4 | iris_meta 파싱 실패 | 기본값으로 폴백 | ☐ |

---

## 5. 샘플 아이템 검증

### 5.1 망치 (Base.Hammer)

| 항목 | 기대값 |
|------|--------|
| 소분류 | Tool.1-A, Tool.1-B, Combat.2-C |
| 주 소분류 | Tool.1-A (기본값) |
| 블록 순서 | Tool.1-A → Tool.1-B → Combat.2-C |
| 블록 수 | 3개 |

**기대 출력**:
```
[Tool · Construction (1-A)]
이 아이템은 건설이나 제작 작업에 사용되는 도구다.
특정 구조물이나 가구를 만들거나 조립할 때 필요하다.

[Tool · Disassembly (1-B)]
이 아이템은 가전제품이나 전자기기를 분해하는 데 사용된다.
특정 아이템을 우클릭하여 분해할 수 있다.

[Combat · Short Blunt (2-C)]
이 아이템은 근접 전투에서 둔기 계열 무기로 취급된다.
한 손으로 사용할 수 있다.
```

☐ 출력 일치 확인

---

### 5.2 프라이팬 (Base.Pan)

| 항목 | 기대값 |
|------|--------|
| 소분류 | Tool.1-D, Combat.2-C |
| 주 소분류 | Tool.1-D (메타 지정 또는 기본값) |
| 블록 순서 | Tool.1-D → Combat.2-C |
| 블록 수 | 2개 |

**기대 출력**:
```
[Tool · Cooking (1-D)]
이 아이템은 음식을 만들거나 조리하는 데 사용된다.
일부 조리 과정에서 필요하다.

[Combat · Short Blunt (2-C)]
이 아이템은 근접 전투에서 둔기 계열 무기로 취급된다.
한 손으로 사용할 수 있다.
```

☐ 출력 일치 확인

---

### 5.3 버번 위스키 (Base.WhiskeyFull)

| 항목 | 기대값 |
|------|--------|
| 소분류 | Consumable.3-B, Consumable.3-C, Consumable.3-D, Resource.4-F |
| 주 소분류 | Consumable.3-B (기본값) |
| 블록 순서 | 3-B → 3-C → 3-D → 4-F |
| 블록 수 | 4개 |

☐ 출력 일치 확인

---

### 5.4 분류 없는 아이템

| 항목 | 기대값 |
|------|--------|
| 소분류 | (없음) |
| 주 소분류 | nil |
| 블록 순서 | (없음) |
| 블록 수 | 0개 |

**기대 출력**:
```
(빈 출력)
```

☐ 오류 없이 빈 출력 확인

---

## 6. 최종 서명

| 항목 | 서명 | 날짜 |
|------|------|------|
| 구현 전 체크리스트 완료 | ________________ | ____-__-__ |
| 구현 중 체크리스트 완료 | ________________ | ____-__-__ |
| 구현 후 체크리스트 완료 | ________________ | ____-__-__ |
| 헌법 준수 검증 완료 | ________________ | ____-__-__ |
| 샘플 검증 완료 | ________________ | ____-__-__ |

---

## 7. 변경 이력

| 버전 | 날짜 | 내용 |
|------|------|------|
| 1.0 | 2026-01-28 | 최초 작성 |
